/*! jQuery Selectorator - v0.1.3 - 2013-11-25
* https://github.com/ngs/jquery-selectorator
* Copyright (c) 2013 Atsushi Nagase; Licensed MIT */
(function(){!function(a){var b,c,d,e,f,g,h,i;return h=a.map,f=a.extend,g=a.inArray,d=function(a,b){return-1!==g(a,b)},e=function(a){return a.replace(/([\!\"\#\$\%\&'\(\)\*\+\,\.\/\:\;<\=>\?\@\[\\\]\^\`\{\|\}\~])/g,"\\$1")},c=function(a,b){return h(a,function(a){return a===b?null:a})},i=function(a){return h(a,function(b,c){return parseInt(c,10)===parseInt(a.indexOf(b),10)?b:null})},b=function(){function b(b,c){this.element=b,this.options=f(f({},a.selectorator.options),c),this.cachedResults={}}return b.prototype.query=function(b){var c;return(c=this.cachedResults)[b]||(c[b]=a(b.replace(/#([^\s]+)/g,"[id='$1']")))},b.prototype.getProperTagName=function(){return this.element[0]?this.element[0].tagName.toLowerCase():null},b.prototype.hasParent=function(){return this.element&&0<this.element.parent().size()},b.prototype.isElement=function(){var a;return a=this.element[0],a&&a.nodeType===a.ELEMENT_NODE},b.prototype.validate=function(a,b,c,e){var f,g;if(null==c&&(c=!0),null==e&&(e=!1),g=this.query(a),c&&1<g.size()||!c&&0===g.size()){if(!b||-1!==a.indexOf(":"))return null;if(f=e?" > ":" ",a=b+f+a,g=this.query(a),c&&1<g.size()||!c&&0===g.size())return null}return d(this.element[0],g.get())?a:null},b.prototype.generate=function(){var a,b,d,e,f;if(!(this.element&&this.hasParent()&&this.isElement()))return[""];for(b=[],f=[this.generateSimple,this.generateAncestor,this.generateRecursive],d=0,e=f.length;e>d;d++)if(a=f[d],b=i(c(a.call(this))),b&&b.length>0)return b;return i(b)},b.prototype.generateAncestor=function(){var c,d,e,f,g,h,i,j,k,l,m,n,o,p;for(g=[],p=this.element.parents(),j=0,m=p.length;m>j;j++){for(d=p[j],c=!0,i=this.generateSimple(null,!1),k=0,n=i.length;n>k;k++)for(h=i[k],f=new b(a(d),this.options).generateSimple(null,!1),l=0,o=f.length;o>l;l++)e=f[l],a.merge(g,this.generateSimple(e,!0,c));c=!1}return g},b.prototype.generateSimple=function(a,b,d){var e,f,g,i,j,k,l,m;for(g=this,i=g.getProperTagName(),j=function(c){return g.validate(c,a,b,d)},m=[[g.getIdSelector],[g.getClassSelector],[g.getIdSelector,!0],[g.getClassSelector,!0],[g.getNameSelector],[function(){return[g.getProperTagName()]}]],k=0,l=m.length;l>k;k++)if(e=m[k],f=e[0].call(g,e[1])||[],f=c(h(f,j)),f.length>0)return f;return[]},b.prototype.generateRecursive=function(){var a,c,d,e;return e=this.getProperTagName(),-1!==e.indexOf(":")&&(e="*"),c=this.element.parent(),d=new b(c).generate()[0],a=c.children(e).index(this.element),e=""+e+":eq("+a+")",""!==d&&(e=d+" > "+e),[e]},b.prototype.getIdSelector=function(a){var b;return null==a&&(a=!1),a=a?this.getProperTagName():"",b=this.element.attr("id"),"string"!=typeof b||d(b,this.getIgnore("id"))?null:[""+a+"#"+e(b)]},b.prototype.getClassSelector=function(a){var b,c,f;return null==a&&(a=!1),f=this.getProperTagName(),/^(body|html)$/.test(f)?null:(a=a?f:"",c=this.getIgnore("class"),b=(this.element.attr("class")||"").replace(/\{.*\}/,"").split(/\s/),h(b,function(b){return b&&!d(b,c)?""+a+"."+e(b):null}))},b.prototype.getNameSelector=function(){var a,b;return b=this.getProperTagName(),a=this.element.attr("name"),a&&!d(a,this.getIgnore("name"))?[""+b+"[name='"+a+"']"]:null},b.prototype.getIgnore=function(a){var b,c,d;return c=this.options.ignore||{},b="class"===a?"classes":""+a+"s",d=c[a]||c[b],"string"==typeof d?[d]:d},b}(),a.selectorator={options:{},unique:i,clean:c,escapeSelector:e},a.fn.selectorator=function(c){return new b(a(this),c)},a.fn.getSelector=function(a){return this.selectorator(a).generate()},this}(jQuery)}).call(this);